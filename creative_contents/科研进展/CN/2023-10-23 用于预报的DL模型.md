
<h2 style='pointer-events: none;'> 用于预报的深度学习模型</h2>
<h3 style='pointer-events: none;'>1.多种深度学习模型进行降雨径流模拟的效果</h3>

主要以LSTM和TCN以及他们的变体为主，从大量文献来看，Bi-LSTM效果相对来说要好一点，主要的模型有：

LSTM：LSTM的作用是提取几个时间步之前的信息作为特征传入当前时间步骤，并且随着时间的临近特征的权重越大，换句话来说，也就是认为前一天的降水比前两天的降水对当前的径流影响更重要，这在降雨径流模拟中是符合直觉的。

CNN-LSTM ：卷积在图像上提取的是某一局部特征，这里用来时间序列上提取的是什么？还没有文献回答这个问题。

Bi-LSTM：双向LSTM其实在NLP问题中对应的是上下文关系的提取，也就是认为某一个字的前面一个字和后面一个字都对这当前的这个字有影响，这在NLP问题中能够阐述清楚，但如果用这个网络架构进行降雨径流模拟，所有文献的做法还是只输出Decoder的最后一个时间步，这就导致反向的这一层LSTM不起任何作用，所谓的Bi-LSTM退化成了简单的LSTM加上一个全连接层，但很多文献指出这样做的效果就是比LSTM好，我怀疑要么就是多加的那个全连接层起了作用，网络变深了，要么就是文章在顺着结果找过程，深度网络训练结果的随机性本身就挺强的
<h3 style='pointer-events: none;'>2.降雨径流模拟的深度学习模型可解释性方法</h3>

①模型训练完之后把模型当成一个黑箱解释

Permutation Importance：实际上就是一种排队论的权重解释方法，在本科数学建模方法里有提到，本质上是一种客观赋权方法

Integrated gradient：跟单变量敏感性分析很像，不同的是，一般水文模型的敏感性分析通常是看NSE的变化，这里给出了一个新的计量公式：

$$
γ(α)=(1-α)x+αx
$$

计算这个公式对于自变量的x的偏导，就可以得到自变量的贡献度，但是没看懂为什么这个公式可以解释。

②根据LSTM层的神经元权重计算哪天的降水（蒸发、径流）最重要，这种方法只考虑到了LSTM层，所谓的可解释性更像是讲故事，不推荐。

③可解释性模块

模型一边训练一遍解释，看起来是最厉害的一种了，但是这个方面有很多种方法，有很多可解释性的组件加在里面，没怎么看懂。
<h3 style='pointer-events: none;'>3.影响模型效果的自变量</h3>

前几天的径流是最重要的驱动因子，随着预见期增加，径流的重要性减弱，降水的重要性增加

有文献拿栅格雨量数据当作输入建立模型，这倒是一个很好的想法，但是显示效果不佳，可能大多数的栅格数据都是点雨量站插值插出来的，引入了太多插值导致的误差和噪声，这里我想用遥感的降水产品有没有可能好一点
<h3 style='pointer-events: none;'>4.建模</h3>

有文献把径流进行时间序列分析，再对分解后的数据进行一一建模，但实际上这种方案跟在网络的最后加一个全连接层的效果是一样的，没有太多意义。总的来说，国内的文献在建模这里最大的问题是没有做好特征工程，也就是没有合适的方法选择模型的驱动因子，这也跟资料匮乏有关，水文资料的数据形式太多，有时间序列，有常数形式的参数，也有栅格数据甚至是栅格数据时间序列，难以做合适的特征选择，但针对单一数据形式的模型，例如输入的全是时间序列形式的降水、径流、蒸发这种模型，就应该尽可能的多找些时间序列特征，例如气温、风速，再选用特征工程筛选特征的方法挖掘合适的特征进行建模。
<h3 style='pointer-events: none;'>5.优化</h3>

大多数改进的模型优化方法还在用PSO、GA这类非梯度下降方法，注意不同于复杂的水文模型，神经网络是可求导的，顺着反向传播能精确的求得每一个神经元每一个参数的导数，用非求导方法就是舍本逐末……

